<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.prime.com.tr/ui">

<ui:composition template="/WEB-INF/includes/layout.xhtml">
	<ui:define name="content">
		<h:form prependId="false">
			<h:panelGrid columns="2" styleClass="containersLayoutTable"
				id="voyagesLayoutTable">

				<p:panel id="containersPanel" style="text-align:center"
					styleClass="toggle-panel">
					<f:facet name="header">
						<h:outputText id="containerTitle"
							value="#{containerBean.containersTitle}" />
					</f:facet>
					<p:autoComplete id="VoyageSearchBoxId"
						value="#{containerBean.selectedVoyage}"
						completeMethod="#{containerBean.voyageAutocomplete}" var="voyage"
						itemValue="#{voyage}" itemLabel="#{voyage.voyageInfo}"
						forceSelection="true" converter="voyagePresentationConverter"
						selectListener="#{containerBean.voyageSelect}"
						onSelectUpdate="containers,infoPanel,containerTitle">
					</p:autoComplete>

					<ui:include src="/WEB-INF/includes/crudToolBar.xhtml">
						<ui:param name="bean" value="#{containerBean}" />
						<ui:param name="gridId" value="containers" />
						<ui:param name="update" value="infoPanel" />
					</ui:include>



					<p:dataTable selectionMode="single" styleClass="cellSmallText"
						id="containers" var="container"
						value="#{containerBean.containers}"
						selection="#{containerBean.containerPresentation}"
						rowStyleClass="#{container.color}" update="infoPanel">

						<p:column sortBy="#{container.number}"
							filterBy="#{container.number}" filterMatchMode="contains">
							<f:facet name="header">Номер</f:facet>
							<h:outputText value="#{container.number}" />
						</p:column>

						<p:column sortBy="#{container.invoiceInLine}"
							filterBy="#{container.invoiceInLine}" filterMatchMode="contains">
							<f:facet name="header">Инвойс</f:facet>
							<h:outputText value="#{container.invoiceInLine}" />
						</p:column>

						<p:column sortBy="#{container.orderInLine}"
							filterBy="#{container.orderInLine}" filterMatchMode="contains">
							<f:facet name="header">Заказ</f:facet>
							<h:outputText value="#{container.orderInLine}" />
						</p:column>

						<p:column sortBy="#{container.billOfLadingInLine}"
							filterBy="#{container.billOfLadingInLine}"
							filterMatchMode="contains">
							<f:facet name="header">Коносамент</f:facet>
							<h:outputText value="#{container.billOfLadingInLine}" />
						</p:column>

						<p:column sortBy="#{container.cargoInLine}"
							filterBy="#{container.cargoInLine}" filterMatchMode="contains">
							<f:facet name="header">Груз</f:facet>
							<h:outputText value="#{container.cargoInLine}" />
						</p:column>

						<p:column sortBy="#{container.city}" filterBy="#{container.city}"
							filterMatchMode="contains">
							<f:facet name="header">Город</f:facet>
							<h:outputText value="#{container.city}" />
						</p:column>

						<p:column sortBy="#{container.state}"
							filterBy="#{container.state}">
							<f:facet name="header">Статус</f:facet>
							<h:outputText value="#{container.state}" />
						</p:column>

					</p:dataTable>

				</p:panel>
				<p:panel id="infoPanel" style="text-align:center">
					<f:facet name="header">
						<h:outputText value="#{containerBean.lazyContainer.number}" />
					</f:facet>
					<h:panelGroup id="lazyContainerInfo" layout="block"
						rendered="#{containerBean.isSelected}">
						<h:outputText styleClass="olive-color" value="Статус: " />
						<h:outputText
							value="#{containerBean.lazyContainerPresentation.state}" />
						<br />
						<h:outputText styleClass="olive-color" value="Инвойс: " />
						<h:outputText
							value="#{containerBean.lazyContainerPresentation.invoiceInLine}" />
						<br />
						<h:outputText styleClass="olive-color" value="Заказ: " />
						<h:outputText
							value="#{containerBean.lazyContainerPresentation.orderInLine}" />
						<br />
						<h:outputText styleClass="olive-color" value="Коносамент: " />
						<h:outputText
							value="#{containerBean.lazyContainerPresentation.billOfLadingInLine}" />
						<br />
						<h:outputText styleClass="olive-color" value="Город: " />
						<h:outputText value="#{containerBean.lazyContainer.city.name}" />
						<br />
						<h:outputText styleClass="olive-color" value="Погрузка: " />
						<h:outputText
							value="#{containerBean.lazyContainer.loadingPort.name}" />
						<h:outputText value=", " />
						<h:outputText value="#{containerBean.lazyContainer.loadingDate}">
							<f:convertDateTime dateStyle="medium" type="date" />
						</h:outputText>
						<br />
						<h:outputText styleClass="olive-color" value="Выгрузка: " />
						<h:outputText
							value="#{containerBean.lazyContainer.dischargePort.name}" />
						<h:outputText value=", " />
						<h:outputText value="#{containerBean.lazyContainer.dischargeDate}">
							<f:convertDateTime dateStyle="medium" type="date" />
						</h:outputText>
					</h:panelGroup>
					<ui:repeat value="#{containerBean.lazyContainer.cargoes}"
						var="cargo">
						<p:panel
							header="#{cargo.article.name}, кат: #{cargo.articleCategory.name}"
							styleClass="container-cargo-panel">
							<h:outputText styleClass="olive-color" value="Поставщик: " />
							<h:outputText value="#{cargo.supplier.company.name}" />
							<ul>
								<ui:repeat value="#{cargo.features}" var="feature">
									<li><h:outputText styleClass="olive-color"
											value="#{feature.feature.name}: " /> <h:outputText
											value="#{feature.value}" /></li>
								</ui:repeat>
							</ul>

						</p:panel>
					</ui:repeat>

				</p:panel>
			</h:panelGrid>
		</h:form>

		<ui:include src="/handbook/dialog/voyageDlg.xhtml">
			<ui:param name="bean" value="#{voyageBean}" />
			<ui:param name="gridId" value="containers" />
			<ui:param name="selectedVessel" value="selectedVessel" />
			<ui:param name="vessels" value="vessels" />
			<ui:param name="title" value="title" />
			<ui:param name="update" value="infoPanel" />
		</ui:include>

	</ui:define>
</ui:composition>
</html>