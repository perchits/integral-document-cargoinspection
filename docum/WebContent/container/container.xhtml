<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.prime.com.tr/ui">

<ui:composition template="/WEB-INF/includes/layout.xhtml">
	<ui:param name="selectedMenuItem" value="4" />
	<f:metadata>
		<f:event type="preRenderView" listener="#{containerBean.loadPage}"></f:event>
	</f:metadata>
	<ui:define name="content">

		<h:panelGrid columns="2" styleClass="containersLayoutTable"
			id="voyagesLayoutTable">

			<p:panel id="containersPanel" style="text-align:left"
				styleClass="toggle-panel">
				<f:facet name="header">
					<h:outputText id="containerTitle"
						value="#{containerBean.containersTitle}" />
					<h:form prependId="false">
						<h:panelGroup id="containercrud"
							styleClass="table-btns container-btns">
							<ui:include src="/WEB-INF/includes/easyCrudToolBar.xhtml">
								<ui:param name="bean" value="#{containerBean}" />
								<ui:param name="gridId" value="containers" />
								<ui:param name="update" value="infoPanel" />
								<ui:param name="newObject" value="newObject" />
								<ui:param name="editObject" value="editObject" />
								<ui:param name="beforeDeleteObject" value="beforeDeleteObject" />
								<ui:param name="refreshObjects" value="refreshObjects" />
								<ui:param name="inspectionBrief" value="true" />
							</ui:include>
						</h:panelGroup>
					</h:form>
				</f:facet>
				<h:form prependId="false">
					<p:autoComplete id="VoyageSearchBoxId"
						value="#{containerBean.selectedVoyage}"
						completeMethod="#{containerBean.voyageAutocomplete}" var="voyage"
						itemValue="#{voyage}" itemLabel="#{voyage.voyageInfo}"
						forceSelection="true" converter="voyagePresentationConverter"
						selectListener="#{containerBean.voyageSelect}"
						onSelectUpdate="containers,infoPanel,containerTitle">
					</p:autoComplete>
				</h:form>

				<h:form prependId="false">
					<p:dataTable selectionMode="single"
						styleClass="cellSmallText containers" id="containers"
						var="container" value="#{containerBean.containers}"
						selection="#{containerBean.container}"
						rowStyleClass="#{container.color}" update="infoPanel">

						<p:column styleClass="c-number" sortBy="#{container.number}"
							filterBy="#{container.number}" filterMatchMode="contains">
							<f:facet name="header">Номер</f:facet>
							<h:outputText value="#{container.number}" />
						</p:column>

						<p:column styleClass="c-bill"
							sortBy="#{container.billOfLadingInLine}"
							filterBy="#{container.billOfLadingInLine}"
							filterMatchMode="contains">
							<f:facet name="header">Коносамент</f:facet>
							<h:outputText value="#{container.billOfLadingInLine}" />
						</p:column>

						<p:column styleClass="c-cargo" sortBy="#{container.cargoInLine}"
							filterBy="#{container.cargoInLine}" filterMatchMode="contains">
							<f:facet name="header">Груз</f:facet>
							<h:outputText value="#{container.cargoInLine}" />
						</p:column>

					</p:dataTable>
				</h:form>
			</p:panel>

			<h:panelGroup id="infoPanel" layout="block">
				<p:panel styleClass="container-cargo-panel"
					rendered="#{!containerBean.isNullContainer}">

					<f:facet name="header">
						<h:panelGroup styleClass="table-header">
							<h:outputText value="#{containerBean.container.number}" />
						</h:panelGroup>
					</f:facet>

					<h:panelGrid columns="3" id="inspection-splitter">

						<h:panelGroup layout="block" id="declared">


							<h:panelGroup id="lazyContainerInfo" layout="block">
								<h:outputText styleClass="olive-color" value="Статус: " />
								<h:outputText value="#{containerBean.container.state}" />

								<h:panelGroup
									rendered="#{containerBean.container.invoiceInLine != null}">
									<br />
									<h:outputText styleClass="olive-color" value="Инвойс: " />
									<h:outputText value="#{containerBean.container.invoiceInLine}" />
								</h:panelGroup>

								<h:panelGroup
									rendered="#{containerBean.container.orderInLine != null}">
									<br />
									<h:outputText styleClass="olive-color" value="Заказ: " />
									<h:outputText value="#{containerBean.container.orderInLine}" />
								</h:panelGroup>

								<h:panelGroup
									rendered="#{containerBean.container.billOfLadingInLine != null}">
									<br />
									<h:outputText styleClass="olive-color" value="Коносамент: " />
									<h:outputText
										value="#{containerBean.container.billOfLadingInLine}" />
								</h:panelGroup>

								<h:panelGroup rendered="#{containerBean.container.city != null}">
									<br />
									<h:outputText styleClass="olive-color" value="Город: " />
									<h:outputText value="#{containerBean.container.city}" />
								</h:panelGroup>

								<h:panelGroup
									rendered="#{containerBean.container.loadingPort != null}">
									<br />
									<h:outputText styleClass="olive-color" value="Погрузка: " />
									<h:outputText value="#{containerBean.container.loadingPort}" />
									<h:outputText value=", " />
									<h:outputText value="#{containerBean.container.loadingDate}">
										<f:convertDateTime dateStyle="medium" type="date" />
									</h:outputText>
								</h:panelGroup>

								<h:panelGroup
									rendered="#{containerBean.container.dischargePort != null}">
									<br />
									<h:outputText styleClass="olive-color" value="Выгрузка: " />
									<h:outputText value="#{containerBean.container.dischargePort}" />
									<h:outputText value=", " />
									<h:outputText value="#{containerBean.container.dischargeDate}">
										<f:convertDateTime dateStyle="medium" type="date" />
									</h:outputText>
								</h:panelGroup>
							</h:panelGroup>

							<ui:include src="/container/include/cargoUnit.xhtml">
								<ui:param name="cargobean"
									value="#{containerBean.declaredCargoUnit}" />
							</ui:include>

						</h:panelGroup>

						<h:panelGroup id="splitter" />

						<h:panelGroup layout="block" id="inspection">Инспекция 
							<!-- ИНСПЕКЦИЯ 
							  <ui:include src="/container/include/inspectionUnit.xhtml">
								<ui:param name="inspectionbean" value="#{containerBean.inspectionUnit}" />
							</ui:include>
							 -->

							<ui:include src="/container/include/cargoUnit.xhtml">
								<ui:param name="cargobean"
									value="#{containerBean.actualCargoUnit}" />
							</ui:include>

						</h:panelGroup>
					</h:panelGrid>


				</p:panel>
			</h:panelGroup>
		</h:panelGrid>



		<!-- Контейнер  -->

		<ui:include src="/container/dialog/containerDlg.xhtml">
			<ui:param name="bean" value="#{containerBean.containerDlg}" />
			<ui:param name="gridId" value="containers" />
			<ui:param name="title" value="title" />
			<ui:param name="update" value="infoPanel" />
			<ui:param name="rendered"
				value="#{containerBean.containerDlg != null}" />
		</ui:include>

		<ui:include src="/WEB-INF/includes/deleteConfirmation.xhtml">
			<ui:param name="message"
				value="Удалить контейнер '#{containerBean.container.number}'?" />
			<ui:param name="gridId" value="containers" />
			<ui:param name="bean" value="#{containerBean}" />
			<ui:param name="update" value="infoPanel" />
			<ui:param name="deleteObject" value="deleteObject" />
		</ui:include>

<!-- Диалог груз  -->

	<ui:include src="/container/dialog/cargoDlg.xhtml">
		<ui:param name="bean"
			value="#{containerBean.dlgCargoUnit.cargoDlg}" />
		<ui:param name="gridId" value="cargoId" />
		<ui:param name="title" value="title" />
		<ui:param name="rendered"
			value="#{containerBean.dlgCargoUnit != null}" />
		<ui:param name="update" value="containers,infoPanel" />
	</ui:include>

	<ui:include src="/WEB-INF/includes/deleteConfirmation.xhtml">
		<ui:param name="message"
			value="Удалить груз '#{containerBean.dlgCargoUnit.cargoName}'?" />
		<ui:param name="gridId" value="cargoId" />
		<ui:param name="bean" value="#{containerBean.dlgCargoUnit}" />
		<ui:param name="deleteObject" value="deleteCargo" />
		<ui:param name="update" value="containers,infoPanel" />
	</ui:include>

<!-- Категории  -->

<ui:include src="/container/dialog/featureDlg.xhtml">
	<ui:param name="bean" value="#{containerBean.dlgFeatureUnit.featureDlg}" />
	<ui:param name="gridId" value="featureId" />
	<ui:param name="title" value="title" />
	<ui:param name="rendered" value="#{containerBean.dlgFeatureUnit != null}" />
	<ui:param name="update" value="infoPanel" />
</ui:include>

<ui:include src="/WEB-INF/includes/deleteConfirmation.xhtml">
	<ui:param name="message"
		value="Удалить свойство груза '#{containerBean.dlgFeatureUnit.featureName}'?" />
	<ui:param name="gridId" value="featureId" />
	<ui:param name="bean" value="#{featurebean}" />
	<ui:param name="deleteObject" value="removeFeature" />
	<ui:param name="update" value="infoPanel" />
</ui:include>

<!-- Упаковка  -->

<ui:include src="/container/dialog/CargoPackageDlg.xhtml">
	<ui:param name="bean" value="#{containerBean.dlgPackageUnit.cargoPackageDlg}" />
	<ui:param name="gridId" value="packageId" />
	<ui:param name="title" value="title" />
	<ui:param name="rendered"
		value="#{containerBean.dlgPackageUnit != null}" />
	<ui:param name="update" value="infoPanel" />
</ui:include>

<ui:include src="/WEB-INF/includes/deleteConfirmation.xhtml">
	<ui:param name="message"
		value="Удалить упаковку «#{containerBean.dlgPackageUnit.packageName}»?" />
	<ui:param name="gridId" value="packageId" />
	<ui:param name="bean" value="#{packagebean}" />
	<ui:param name="deleteObject" value="removePackage" />
	<ui:param name="update" value="infoPanel" />
</ui:include>

<!-- Калибры  -->

<ui:include src="/container/dialog/calibreDlg.xhtml">
	<ui:param name="bean" value="#{containerBean.dlgCalibreUnit.calibreDlg}" />
	<ui:param name="gridId" value="calibreId" />
	<ui:param name="title" value="title" />
	<ui:param name="rendered"
		value="#{containerBean.dlgCalibreUnit != null}" />
	<ui:param name="update" value="infoPanel" />
</ui:include>

<ui:include src="/WEB-INF/includes/deleteConfirmation.xhtml">
	<ui:param name="message"
		value="Удалить калибр '#{containerBean.dlgCalibreUnit.calibre.calibreValue}'?" />
	<ui:param name="gridId" value="calibreId" />
	<ui:param name="bean" value="#{calibrebean}" />
	<ui:param name="deleteObject" value="removeCalibre" />
	<ui:param name="update" value="infoPanel" />
</ui:include>

	</ui:define>

</ui:composition>
</html>